```<!doctype html><!-- © 1998 - 2021 DPG Online Services B.V. -->
<html lang="NL"><head>
        
                            <meta http-equiv="content-type" content="text/html; charset=utf-8">
                                                <meta name="referrer" content="origin-when-cross-origin">
                            
                    <title>Roels knutselblog - Tweakers</title>
        <link rel="navigator" title="Spring voorbij navigatie" href="https://alphyraz.tweakblogs.net/#contentArea">

            <link rel="preload" href="https://tweakers.net/x/fonts/IBMPlexSansCondensed-Regular.woff2" as="font" type="font/woff2" crossorigin>
            <link rel="preload" href="https://tweakers.net/x/fonts/IBMPlexSansCondensed-SemiBold.woff2" as="font" type="font/woff2" crossorigin>

                                            <link rel="shortcut icon" href="https://tweakers.net/favicon.ico" type="image/x-icon">
                            <link rel="alternate" title="Roels knutselblog - Reacties" type="application/rss+xml" href="https://alphyraz.tweakblogs.net/feed/comments">
                            <link rel="alternate" title="Roels knutselblog" type="application/rss+xml" href="https://alphyraz.tweakblogs.net/feed/">
            
        <script>
                var relaxedDomain  = 'tweakers.net',
                    tweakersConfig = {"BaseURL":"https:\/\/alphyraz.tweakblogs.net\/","TnetBaseURL":"https:\/\/tweakers.net\/","ForumBaseURL":"https:\/\/gathering.tweakers.net\/","ImgURL":"https:\/\/tweakers.net\/","sidName":"__Secure-TnetID","UserID":0,"requestId":"Twk-eun-web1_200.1.0_17498_600b8c90d36225.10635561","abStatsPath":"\/ajax\/6rTU6NZ5yTpSlRK5irpKngeRMt\/","loginJs":"https:\/\/tweakers.net\/x\/scripts\/min\/login.js?1605690650","loginCss":"https:\/\/tweakers.net\/x\/styles\/profiles\/login.css?1583238942","clickToLoad":false};

                try
                {
                    document.domain = relaxedDomain;
                }
                catch (e)
                {
                    relaxedDomain = '';
                }
                document.documentElement.className = 'js';
            </script>
        <link rel="stylesheet" href="https://tweakers.net/x/styles/tweakblogs/weblogs.css?1608112821" type="text/css">
                                        <script src="https://tweakers.net/x/build/runtime.36cbb21e.js"></script><script src="https://tweakers.net/x/build/0.3c968efc.js"></script><script src="https://tweakers.net/x/build/1.fe0b8bdd.js"></script><script src="https://tweakers.net/x/build/frontpage.e631087f.js"></script>

                    <script src="https://tweakers.net/x/scripts/min/general.js?1605696722"></script>
            <script src="https://tweakers.net/x/scripts/min/weblogs.js?1604565751"></script>
            <script src="https://tweakers.net/x/scripts/min/rml_toolbar.js?1605522743"></script>
                    <script>
            var _wtq=[['_init',{"randomId":"560631881470949","trackId":"318816705845986","trackDomain":"tweakers.net","domain":"tweakers.net;gathering.tweakers.net","cookie":"1","mediaCode":"wt_mc","contentId":"","contentGroup":{"1":"tweakers.net","2":"Tweakblogs"},"executePluginFunction":"wt_urlCampaignMapper;wt_stats_plugin","requestObfuscation":true,"customParameter":{"1":"LG"}}],['_trackPage']];
			loadJS('https://tweakers.net/x/scripts/min/160huGp.js',AbStats.wtCallBack);

        </script>
    
    </head>
    <body>

    <div id="container">    <div id="tweakblogsNav">
        <div class="logo"><a href="https://tweakblogs.net/"><img src="https://tweakers.net/g/if/weblogs/tweakblogs.png" width=131 height=20 alt="Tweakblogs"></a></div>
        <ul>
            <li><a href="https://tweakblogs.net/">Tweakblogs Home</a></li>
            <li><a href="https://tweakers.net/">Tweakers</a></li>
                            <li>
                    <a href="https://tweakers.net/nieuws/">Nieuws</a>
                </li>
                            <li>
                    <a href="https://tweakers.net/reviews/">Reviews</a>
                </li>
                            <li>
                    <a href="https://tweakers.net/pricewatch/">Pricewatch</a>
                </li>
                            <li>
                    <a href="https://tweakers.net/aanbod/">Vraag &amp; Aanbod</a>
                </li>
                            <li>
                    <a href="https://gathering.tweakers.net/">Forum</a>
                </li>
                            <li>
                    <a href="https://tweakers.net/carriere/">Carri&egrave;re</a>
                </li>
                            <li>
                    <a href="#">Meer</a>
                </li>
                    </ul>
    </div>
    <div id="banner">
    
        
    <h1><a href="https://alphyraz.tweakblogs.net">Roels knutselblog</a></h1>
            <span class="subtitle">Development, prutsels, mooie prutsels en overige grapjes</span>
    </div>
            <p class="breadCrumb">
                <a href="https://alphyraz.tweakblogs.net/feed/" title="Roels knutselblog" rel="nofollow">
            <img src="https://tweakers.net/g/if/v2/icons/rss_small.png" width=12 height=12 alt="[RSS]">
        </a>
                                <a href="https://alphyraz.tweakblogs.net">            Home            </a>
            </p>
<div id="pagebody">
                <div class="columnwrapper normal">    <div class="content">
			<div class="blogpost">
				<h2><a href="https://alphyraz.tweakblogs.net/blog/17760/solis-omvormer-uitlezen-met-een-raspberry-pi">Solis-omvormer uitlezen met een Raspberry Pi</a></h2>
				<p class="author">
					Door <a href="https://tweakers.net/gallery/416236/" rel="nofollow">Alphyraz</a> op donderdag 12 september 2019 11:20 - <a href="https://alphyraz.tweakblogs.net/blog/17760/solis-omvormer-uitlezen-met-een-raspberry-pi#reacties">Reacties (12)</a><br>Categorie: -, Views: 3.084
				</p>
				<div class="article">Hoi en welkom op mijn eerste tweakblog.<br>
<br>
Allereerst wil ik voor deze tweakblog even de moeite nemen om degene te bedanken die het topic heeft geschreven waarop deze tweablog is gebaseerd en/of van is gejat. Grote dank de schrijver van <a href="https://gathering.tweakers.net/forum/list_messages/1900048" rel="external">dit topic</a> (hierna &quot;het topic&quot;) voor het uitvogelen van hoe het een en ander werkt. Met mijn beperkte hardware- en seriële kennis was me dit niet gelukt. <img src="https://tweakers.net/g/s/smile.gif" width="15" height="15" alt=":)"><br>
<br>
Deze tweakblog is een beetje een mix tussen mijn ervaring en een how-to. In principe zou je de stappen die ik gedaan heb ook moeten kunnen volgen.<br>
<br>
Even wat achtergrondinformatie. Onlangs hebben wij op het dak zonnepanelen laten plaatsen en de omvormer die we hebben is van het merk Solis. De Solis mini 4G om precies te zijn. Het leek mij prettig om de opbrengst van de zonnepanelen bij te houden en op te slaan in mijn bestaande Domoticz-installatie. Waarom?<ul><li>Inzicht in de opbrengst van de zonnepanelen, zonder dat ik zelf naar de omvormer hoef te lopen om te kijken</li><li>Weer inzicht in het totale stroomverbruik, aangezien onze slimme meter niet aangeeft hoeveel stroom er in totaal verbruikt is, maar slechts hoeveel er van het net gehaald is en is teruggeleverd</li><li>Ik heb liever data lokaal staan dan in de cloud</li><li>Omdat het kan</li></ul>De organisatie waar ik mijn zonnepanelen bij heb aangeschaft en die ze hebben geïnstalleerd, heeft mij een zogeheten data logging stick gegeven. Dat is simpel gezegd een stick die je aan de onderzijde van je omvormer erin plugt. Vervolgens leest deze data logging stick informatie uit van de omvormer en stuurt deze door naar derde partij. Dit apparaat zet een access point op waarmee je moet verbinden, waar je vervolgens via een interne portal het apparaat met je eigen WiFi-netwerk kunt verbinden zodat 'ie de data kan doorsturen naar een derde partij in de cloud.<br>
<br>
Ik ben niet zo'n fan van clouds. De redenen hiervoor laat ik even in het midden, maar ik wil de data dus lokaal (thuis) opslaan en niet in de cloud.<br>
<br>
Ik heb overwogen om de data logging stick via een lokale DNS-server te laten verwijzen naar een lokale webserver of iets dergelijks om de data die 'ie verstuurt op te pakken en in Domoticz te plaatsen in plaats van dat de data naar een onzichtbaar wolkje gaat. Man-in-the-middle dus.<br>
<br>
Een andere optie was om zelf iets te knutselen waarbij ik zélf de omvormer uitlees en in Domoticz plaats. Waarschijnlijk meer werk, maar persoonlijk vond ik het logischer dan een man-in-the-middle-oplossing (leuk woord voor galgje). Die weg ben ik dus ingeslagen.<br>
<br>
Vervolgens dus aan de slag gegaan en onderzoek gedaan hoe ik dit zelf kon doen. De omvormer in kwestie schijnt uit te lezen te zijn middels de COM-poort die aan onderzijde van de omvormer te vinden in. Het dopje kun je eraf draaien, waarna vier pinnen in een ronde connector je hartelijk begroeten. Het topic leert mij dat dit een RS485-aansluiting is. Na even Googelen kwam ik tot de conclusie dat dit een seriële interface is voor telecommunicatie. Maar aan de onderkant van de omvormer zit slechts een aansluiting waar vier pinnen uitsteken en die in de verste verte niet op een telefoonaansluiting of iets soortgelijks lijkt, dus wat nu?  <img src="https://tweakers.net/g/s/confused.gif" width="19" height="15" alt=":?"><br>
<br>
Ik kon op internet weinig specificaties vinden over de omvormer en kon dus ook niet zo 1-2-3 achterhalen wat voor type connector ik moest gebruiken die ik op deze pinnen kon pluggen.<br>
<br>
Zoals gezegd heb ik een data logging stick die juist een connector heeft om op die COM-poort aan te sluiten. Je voelt het al aankomen: de maniak in mij kwam naar boven met het idee om de connector hiervan te amputeren en te doneren aan mijn eigen systeem. Altijd handig, die donorhardware. Ik heb de data logging stick voorzichtig opengemaakt en de connector losgemaakt van de printplaat. Dat kun je hieronder goed zien.<br>
<a href="https://tweakers.net/ext/f/mYa6gzmxfnWQrWEMbBqNQeE5/full.jpg" rel="external"><noscript class="lazycontent"><img src="https://tweakers.net/ext/f/mYa6gzmxfnWQrWEMbBqNQeE5/full.jpg" class="rml" width="504" height="378" alt="https://tweakers.net/ext/f/mYa6gzmxfnWQrWEMbBqNQeE5/full.jpg" title="https://tweakers.net/ext/f/mYa6gzmxfnWQrWEMbBqNQeE5/full.jpg"></noscript></a><br>
Maar dat ziet er heel goed uit! Uit de connector steken vier draden die hoogstwaarschijnlijk overeenkomen met de gaten waar de pinnen uit de COM-poort van de omvormer in passen.<br>
<br>
Nu heb ik de luxe dat ik een data logging stick had met deze connector, maar andere mensen hebben deze mogelijk niet. Helaas weet ik nog steeds niet wat voor soort connector het is. Ik heb er een en weet ongeveer hoe hij werkt, maar ik heb geen idee hoe hij heet. Mocht iemand dit wel weten, laat dit dan alsjeblieft weten. <img src="https://tweakers.net/g/s/smile.gif" width="15" height="15" alt=":)"><br>
<br>
Mijn volgende stap was het aansluiten van deze connector op mijn Raspberry Pi. Het topic gebruikt hiervoor een apart bordje dat je op een Raspberry Pi kunt aansluiten. Echter zit er op mijn Pi Zero geen GPIO-header, dus ik heb naar iets anders gezocht. Ik kwam toen op het volgende product uit: <a href="https://www.hobbyelectronica.nl/product/max485-module-voor-rs485-seriele-communicatie-usb/" rel="external nofollow">MAX485 module voor RS485 seriële communicatie USB</a>. Deze zag er simpel uit en was niet duur. Besteld en een paar dagen later lag 'ie op de deurmat.<br>
<br>
Het is even goed kijken hoe je de connector moet aansluiten op de COM-poort op de omvormer en hoe je de draden uit de connector moet aansluiten op de RS485 USB-stick. Het topic leert mij dat er bij iedere pin op de omvormer een nummer staat. Dat klopt inderdaad. En nog mooier: op de connector die ik had stonden óók nummers. Het moet niet gekker worden. Zie hieronder hoe dat eruit ziet.<br>
<a href="https://tweakers.net/ext/f/FUHqebMHJWokgx821fXIF978/full.jpg" rel="external"><noscript class="lazycontent"><img src="https://tweakers.net/ext/f/FUHqebMHJWokgx821fXIF978/full.jpg" class="rml" width="504" height="378" alt="https://tweakers.net/ext/f/FUHqebMHJWokgx821fXIF978/full.jpg" title="https://tweakers.net/ext/f/FUHqebMHJWokgx821fXIF978/full.jpg"></noscript></a><br>
Het mooie is overigens dat er door een geultje in de connector en pin in de COM-poort de connector er maar op één manier in past.<br>
<br>
Ik heb in de tussentijd wat zitten rotzooien met de connector die in de omvormer past en uiteindelijk heb ik alle draden zo kort mogelijk afgeknipt (eigenlijk gewoon zodat er niets meer uitsteekt) en vervolgens aan de uiteinden van pin 3 en 4 nieuwe draden gesoldeerd. Ik ben me bewust van het feit dat het geen perfect soldeerwerk is. Dit was voor mij de eerste keer solderen en ik ben vrij trots op het resultaat voor een eerste keer. <img src="https://tweakers.net/g/s/smile.gif" width="15" height="15" alt=":)"><br>
<a href="https://tweakers.net/ext/f/2jd9Djckk336iEG5qZ4CDrEF/full.jpg" rel="external"><noscript class="lazycontent"><img src="https://tweakers.net/ext/f/2jd9Djckk336iEG5qZ4CDrEF/full.jpg" class="rml" width="378" height="504" alt="https://tweakers.net/ext/f/2jd9Djckk336iEG5qZ4CDrEF/full.jpg" title="https://tweakers.net/ext/f/2jd9Djckk336iEG5qZ4CDrEF/full.jpg"></noscript></a><br>
De RS485 USB-stick heeft aan de achterkant ruimte om twee draden in te steken en vast te draaien, net zoals bij een kroonsteen. Deze gaten hebben beide een naam: A en B. Volgens het topic sluit je de draad uit pin 3 aan op A en de draad uit pin 4 aan op B. Zo gezegd, zo gedaan, zoals je op bovenstaande afbeelding kunt zien.<br>
<br>
Vervolgens heb ik met een USB naar micro USB converter de RS485 USB-stick aangesloten op de Pi Zero en de Pi opgestart.<br>
<br>
Toen 'ie eenmaal opgestart was ben ik ingelogd via SSH. Daar vervolgens de volgende commando's uitgevoerd om de benodigde seriële libraries te kunnen gebruiken in Python:<br>
<div class="code">code:<br><table class="phphighlight"><tr><td class="phphighlightline"><pre>1
2
3
</pre></td><td class="phphighlightcode"><div><pre>sudo apt-get install python python-pip 
sudo python -m pip install pyserial
sudo pip install minimalmodbus</pre></div></td></tr></table></div><br>
En vervolgens het daadwerkelijke Python-script om de seriële poort uit te lezen:<br>
<div class="code">Python:<br><table class="phphighlight"><tr><td class="phphighlightline"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="phphighlightcode"><div><pre><span class="code_kn">import</span> <span class="code_nn">minimalmodbus</span>
<span class="code_kn">import</span> <span class="code_nn">serial</span>
<span class="code_kn">import</span> <span class="code_nn">time</span>

<span class="code_n">instrument</span> <span class="code_o">=</span> <span class="code_n">minimalmodbus</span><span class="code_o">.</span><span class="code_n">Instrument</span><span class="code_p">(</span><span class="code_s1">&#39;/dev/ttyUSB0&#39;</span><span class="code_p">,</span> <span class="code_mi">1</span><span class="code_p">)</span>
<span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">serial</span><span class="code_o">.</span><span class="code_n">baudrate</span> <span class="code_o">=</span> <span class="code_mi">9600</span>
<span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">serial</span><span class="code_o">.</span><span class="code_n">bytesize</span> <span class="code_o">=</span> <span class="code_mi">8</span>
<span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">serial</span><span class="code_o">.</span><span class="code_n">parity</span>   <span class="code_o">=</span> <span class="code_n">serial</span><span class="code_o">.</span><span class="code_n">PARITY_NONE</span>
<span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">serial</span><span class="code_o">.</span><span class="code_n">stopbits</span> <span class="code_o">=</span> <span class="code_mi">1</span>
<span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">serial</span><span class="code_o">.</span><span class="code_n">timeout</span>  <span class="code_o">=</span> <span class="code_mi">3</span>

<span class="code_k">try</span><span class="code_p">:</span>
        <span class="code_n">Realtime_ACW</span> <span class="code_o">=</span> <span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">read_long</span><span class="code_p">(</span><span class="code_mi">3004</span><span class="code_p">,</span> <span class="code_n">functioncode</span><span class="code_o">=</span><span class="code_mi">4</span><span class="code_p">,</span> <span class="code_n">signed</span><span class="code_o">=</span><span class="code_bp">False</span><span class="code_p">)</span> <span class="code_c1">#Read AC Watts as Unsigned 32-Bit</span>
        <span class="code_k">print</span><span class="code_p">(</span><span class="code_s2">&quot;AC Watts: &quot;</span> <span class="code_o">+</span> <span class="code_nb">str</span><span class="code_p">(</span><span class="code_n">Realtime_ACW</span><span class="code_p">)</span> <span class="code_o">+</span> <span class="code_s2">&quot; W&quot;</span><span class="code_p">)</span>
        <span class="code_n">Realtime_DCV</span> <span class="code_o">=</span> <span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">read_register</span><span class="code_p">(</span><span class="code_mi">3021</span><span class="code_p">,</span> <span class="code_n">numberOfDecimals</span><span class="code_o">=</span><span class="code_mi">0</span><span class="code_p">,</span> <span class="code_n">functioncode</span><span class="code_o">=</span><span class="code_mi">4</span><span class="code_p">,</span> <span class="code_n">signed</span><span class="code_o">=</span><span class="code_bp">False</span><span class="code_p">)</span> <span class="code_c1">#Read DC volts as Unsigned 16-Bit</span>
        <span class="code_k">print</span><span class="code_p">(</span><span class="code_s2">&quot;DC Volt: &quot;</span> <span class="code_o">+</span> <span class="code_nb">str</span><span class="code_p">(</span><span class="code_n">Realtime_DCV</span><span class="code_o">/</span><span class="code_mi">100</span><span class="code_p">)</span> <span class="code_o">+</span> <span class="code_s2">&quot; V&quot;</span><span class="code_p">)</span>
        <span class="code_n">Realtime_DCI</span> <span class="code_o">=</span> <span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">read_register</span><span class="code_p">(</span><span class="code_mi">3022</span><span class="code_p">,</span> <span class="code_n">numberOfDecimals</span><span class="code_o">=</span><span class="code_mi">0</span><span class="code_p">,</span> <span class="code_n">functioncode</span><span class="code_o">=</span><span class="code_mi">4</span><span class="code_p">,</span> <span class="code_n">signed</span><span class="code_o">=</span><span class="code_bp">False</span><span class="code_p">)</span> <span class="code_c1">#Read DC current as Unsigned 16-Bit</span>
        <span class="code_k">print</span><span class="code_p">(</span><span class="code_s2">&quot;DC Current: &quot;</span> <span class="code_o">+</span> <span class="code_nb">str</span><span class="code_p">(</span><span class="code_n">Realtime_DCI</span><span class="code_p">)</span> <span class="code_o">+</span> <span class="code_s2">&quot; A&quot;</span><span class="code_p">)</span>
        <span class="code_n">Realtime_ACV</span> <span class="code_o">=</span> <span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">read_register</span><span class="code_p">(</span><span class="code_mi">3035</span><span class="code_p">,</span> <span class="code_n">numberOfDecimals</span><span class="code_o">=</span><span class="code_mi">0</span><span class="code_p">,</span> <span class="code_n">functioncode</span><span class="code_o">=</span><span class="code_mi">4</span><span class="code_p">,</span> <span class="code_n">signed</span><span class="code_o">=</span><span class="code_bp">False</span><span class="code_p">)</span> <span class="code_c1">#Read AC volts as Unsigned 16-Bit</span>
        <span class="code_k">print</span><span class="code_p">(</span><span class="code_s2">&quot;AC volt: &quot;</span> <span class="code_o">+</span> <span class="code_nb">str</span><span class="code_p">(</span><span class="code_n">Realtime_ACV</span><span class="code_o">/</span><span class="code_mi">10</span><span class="code_p">)</span> <span class="code_o">+</span> <span class="code_s2">&quot; V&quot;</span><span class="code_p">)</span>
        <span class="code_n">Realtime_ACI</span> <span class="code_o">=</span> <span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">read_register</span><span class="code_p">(</span><span class="code_mi">3038</span><span class="code_p">,</span> <span class="code_n">numberOfDecimals</span><span class="code_o">=</span><span class="code_mi">0</span><span class="code_p">,</span> <span class="code_n">functioncode</span><span class="code_o">=</span><span class="code_mi">4</span><span class="code_p">,</span> <span class="code_n">signed</span><span class="code_o">=</span><span class="code_bp">False</span><span class="code_p">)</span> <span class="code_c1">#Read AC current as Unsigned 16-Bit</span>
        <span class="code_k">print</span><span class="code_p">(</span><span class="code_s2">&quot;AC Current: &quot;</span> <span class="code_o">+</span> <span class="code_nb">str</span><span class="code_p">(</span><span class="code_n">Realtime_ACI</span><span class="code_p">)</span> <span class="code_o">+</span> <span class="code_s2">&quot; A&quot;</span><span class="code_p">)</span>
        <span class="code_n">Realtime_ACF</span> <span class="code_o">=</span> <span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">read_register</span><span class="code_p">(</span><span class="code_mi">3042</span><span class="code_p">,</span> <span class="code_n">numberOfDecimals</span><span class="code_o">=</span><span class="code_mi">0</span><span class="code_p">,</span> <span class="code_n">functioncode</span><span class="code_o">=</span><span class="code_mi">4</span><span class="code_p">,</span> <span class="code_n">signed</span><span class="code_o">=</span><span class="code_bp">False</span><span class="code_p">)</span> <span class="code_c1">#Read AC frequency as Unsigned 16-Bit</span>
        <span class="code_k">print</span><span class="code_p">(</span><span class="code_s2">&quot;AC Frequency: &quot;</span> <span class="code_o">+</span> <span class="code_nb">str</span><span class="code_p">(</span><span class="code_n">Realtime_ACF</span><span class="code_o">/</span><span class="code_mi">100</span><span class="code_p">)</span> <span class="code_o">+</span> <span class="code_s2">&quot; Hz&quot;</span><span class="code_p">)</span>
        <span class="code_n">Inverter_C</span> <span class="code_o">=</span> <span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">read_register</span><span class="code_p">(</span><span class="code_mi">3041</span><span class="code_p">,</span> <span class="code_n">numberOfDecimals</span><span class="code_o">=</span><span class="code_mi">0</span><span class="code_p">,</span> <span class="code_n">functioncode</span><span class="code_o">=</span><span class="code_mi">4</span><span class="code_p">,</span> <span class="code_n">signed</span><span class="code_o">=</span><span class="code_bp">True</span><span class="code_p">)</span> <span class="code_c1">#Read inverter temperature as Signed 16-Bit</span>
        <span class="code_k">print</span><span class="code_p">(</span><span class="code_s2">&quot;Inverter temperature: &quot;</span> <span class="code_o">+</span> <span class="code_nb">str</span><span class="code_p">(</span><span class="code_n">Inverter_C</span><span class="code_o">/</span><span class="code_mi">10</span><span class="code_p">)</span> <span class="code_o">+</span> <span class="code_s2">&quot; C&quot;</span><span class="code_p">)</span>
        <span class="code_n">AlltimeEnergy_KWH</span> <span class="code_o">=</span> <span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">read_long</span><span class="code_p">(</span><span class="code_mi">3008</span><span class="code_p">,</span> <span class="code_n">functioncode</span><span class="code_o">=</span><span class="code_mi">4</span><span class="code_p">,</span> <span class="code_n">signed</span><span class="code_o">=</span><span class="code_bp">False</span><span class="code_p">)</span> <span class="code_c1">#Read all time energy (kWh total) as Unsigned 32-Bit</span>
        <span class="code_k">print</span><span class="code_p">(</span><span class="code_s2">&quot;Generated all time: &quot;</span> <span class="code_o">+</span> <span class="code_nb">str</span><span class="code_p">(</span><span class="code_n">AlltimeEnergy_KWH</span><span class="code_p">)</span> <span class="code_o">+</span> <span class="code_s2">&quot; kWh&quot;</span><span class="code_p">)</span>
        <span class="code_n">Today_KWH</span> <span class="code_o">=</span> <span class="code_n">instrument</span><span class="code_o">.</span><span class="code_n">read_register</span><span class="code_p">(</span><span class="code_mi">3014</span><span class="code_p">,</span> <span class="code_n">numberOfDecimals</span><span class="code_o">=</span><span class="code_mi">1</span><span class="code_p">,</span> <span class="code_n">functioncode</span><span class="code_o">=</span><span class="code_mi">4</span><span class="code_p">,</span> <span class="code_n">signed</span><span class="code_o">=</span><span class="code_bp">False</span><span class="code_p">)</span> <span class="code_c1">#Read todays energy (kWh total) as 16-Bit</span>
        <span class="code_k">print</span><span class="code_p">(</span><span class="code_s2">&quot;Generated today: &quot;</span> <span class="code_o">+</span> <span class="code_nb">str</span><span class="code_p">(</span><span class="code_n">Today_KWH</span><span class="code_p">)</span> <span class="code_o">+</span> <span class="code_s2">&quot; kWh&quot;</span><span class="code_p">)</span>

<span class="code_k">except</span> <span class="code_ne">Exception</span><span class="code_p">,</span> <span class="code_n">e</span><span class="code_p">:</span>
        <span class="code_k">print</span><span class="code_p">(</span><span class="code_nb">str</span><span class="code_p">(</span><span class="code_n">e</span><span class="code_p">));</span></pre></div></td></tr></table></div><br>
Je kunt dit script aanmaken en opslaan met bijvoorbeeld nano. Ik prefereer nano omdat ik nog regelmatig badend in het zweet wakker word van de talloze keren dat ik niet meer kon ontsnappen uit Vim.<br>
<div class="code">code:<br><table class="phphighlight"><tr><td class="phphighlightline"><pre>1
</pre></td><td class="phphighlightcode"><div><pre>nano inverter.py</pre></div></td></tr></table></div><br>
Plak vervolgens de code in nano en sla op met <b>CTRL + O</b>, <b>CTRL + W</b> (ja, ik zet het er maar even bij want voor de niet-Linux-gurus is het ook soms nog een hele strijd om uit nano te komen).<br>
Dit script is ook gebaseerd op het topic maar ik heb alles wat ik niet nodig had eruit gehaald en enigszins aangepast. Ik adviseer sterk je om met dit minimale script éérst te kijken of je data kunt uitlezen van de omvormer alvorens je deze data gaat verwerken. Ik had namelijk eerst het volledige script uit het topic gepakt en geprobeerd te gebruiken. Dit resulteerde vervolgens in de volgende foutmelding bij mij:<blockquote><div class="quote">No communication with the instrument (no answer)</div></blockquote>Hoewel dit impliceert dat er niets over de seriële interface ging, leek het daar niet aan te liggen. Toen ik alle niet-essentiële stukken uit dat script had verwijderd werkte het namelijk wél. Voordat ik dit geprobeerd had, had ik namelijk al de draden doorgeknipt waardoor ik vervolgens mocht gaan solderen, terwijl het waarschijnlijk ook al met de draden was gelukt die al aan de connector zaten. Dus, doe jezelf en lol en test eerst het minimale alvorens je verdergaat. <img src="https://tweakers.net/g/s/wink.gif" width="15" height="15" alt=";)"><br>
<br>
Vervolgens het Python-script uitvoeren:<br>
<div class="code">code:<br><table class="phphighlight"><tr><td class="phphighlightline"><pre>1
</pre></td><td class="phphighlightcode"><div><pre>python inverter.py</pre></div></td></tr></table></div><br>
Wanneer ik het aangepaste script draaide, kwam er wonder boven wonder échte data uit de omvormer!  <img src="https://tweakers.net/g/s/biggrin.gif" width="15" height="15" alt=":D"><br>
<noscript class="lazycontent"><img src="https://tweakers.net/ext/f/B2dEWNyvXWg3AINsaeMf0I3u/full.png" class="rml" width="565" height="290" alt="https://tweakers.net/ext/f/B2dEWNyvXWg3AINsaeMf0I3u/full.png" title="https://tweakers.net/ext/f/B2dEWNyvXWg3AINsaeMf0I3u/full.png"></noscript><br>
<br>
Krijg je bovenstaande melding met een minimaal script? Blijf kalm. Probeer het script nog een paar keer uit te voeren. Af en toe krijg ik namelijk deze melding nog en vervolgens niet meer. Blijft je script falen? Blijf dan nog steeds kalm. Controleer of alles goed is aangesloten. Blijft het script nog stééds falen? Dan is het nu tijd om in paniek te raken. Pak je gereedschap erbij en loop alles nog eens na.<br>
<br>
De volgende stap is natuurlijk het opslaan van deze data. Momenteel ben ik daar nog mee bezig en dat lijkt me ook wel een eigen blog waard.<br>
<br>
De highlights van dit kleine maar toch veelomvattende project:<ul><li>Voor de eerste keer hardwareorgaandonatie ingezet</li><li>Voor de eerste keer iets met seriële communicatie gedaan</li><li>Mijn eerste échte regel Python-code getikt</li><li>Voor de eerste keer van mijn leven zelf gesoldeerd</li><li>Eerst goed controleren of het écht niet aan je software ligt alvorens je kabels doorknipt</li><li>Voor de eerste keer een tweakblog geschreven</li></ul>Voor nu hoop ik dat jullie iets aan deze blog hebben gehad. Als je vragen en/of opmerkingen hebt, stel ze dan gerust.</div>
			</div></div><div class="sidebar">
        <div id="loginFrame">
            <h2 class="top">Inloggen</h2>
            <p>Login met je  <a href="https://tweakblogs.net/login/?location=https%3A%2F%2Falphyraz.tweakblogs.net%2F">Tweakers profiel</a>.</p>
        </div>
		<div class="recentPosts">
			<h4>Recente posts</h4><ul class="ellipsis"><li><a href="https://alphyraz.tweakblogs.net/blog/17760/solis-omvormer-uitlezen-met-een-raspberry-pi" title="Solis-omvormer uitlezen met een Raspberry Pi (12)">Solis-omvormer uitlezen met een Raspberry Pi (12)</a></li></ul>
		</div>
		<div class="categories">
			<h4>Categorieën</h4><p>Er zijn nog geen categorieën beschikbaar.</p>
		</div>
		<div class="archives">
			<h4>Archieven</h4><ul id="archiveList"><li class="open"><b>2019</b> (1)<ul class="ulChild"><li><a href="https://alphyraz.tweakblogs.net/blog/archief/2019/09/">sep 2019</a> (1)</li></ul></li></ul><script type="text/javascript">weblogFolderTree('archiveList');</script>
		</div>
		<div class="about">
			<h4>About</h4>
			<p></p>
			<ul>
				<li class="user"><a href="https://tweakers.net/gallery/416236/" rel="nofollow">Profiel op Tweakers</a></li>
			</ul>
		</div></div>
</div>
            </div>

        </div>    <script>
                if(window.BehaviourManager)BehaviourManager.exec();
            </script>
    <noscript>
                    <img src="https://tweakers.net/318816705845986/wt?p=328,&amp;cg1=tweakers.net&amp;cg2=Tweakblogs&amp;cp1=LG" width="1" height="1" alt="" style="display:none">
            </noscript>

<!--
Request ID: Twk-eun-web1_200.1.0_17498_600b8c90d36225.10635561
Env: frontpage-production
Server time: 0,0172 s (C: 0,0141 s, Q: 5; 0,0056 s, E: 1; 0,0152 s, M: 2; 0,0026 s, A: 0; 0,0000 s)
Mem: 4595 KB

Engines: (S) twk-eun-web2 (1)
-->
        
    </body>
</html>
```